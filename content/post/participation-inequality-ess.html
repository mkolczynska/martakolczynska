---
title: "Inequality of political participation, European Social Survey 8"
author: "Marta Kołczyńska"
date: 2018-07-30T03:41:00
categories: ["R"]
tags: ["surveys", "ESS", "R", "political inequality"]

---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotlyjs/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotlyjs/plotly-latest.min.js"></script>


<div id="inequality-of-political-participation" class="section level4">
<h4>Inequality of political participation</h4>
<pre class="r"><code>library(ess)
library(democracyData) # devtools::install_github(&quot;xmarquez/democracyData&quot;)
library(vdem) # devtools::install_github(&quot;xmarquez/vdem&quot;)

library(tidyverse) # manipulating the data
library(labelled) # dealing with data labels
library(plyr) # mapvalues
library(countrycode) # converting country codes

library(reldist) # gini index
library(DescTools) # Atkinson index
library(entropy) # entropy

library(plotly) # interactive plots
library(corrplot) # colored correlation matrix

library(rijkspalette) # pretty colors for the graphs</code></pre>
</div>
<div id="ess-data" class="section level4">
<h4>ESS data</h4>
<pre class="r"><code>ess8 &lt;- ess_rounds(c(8), &quot;mkolczynska@gmail.com&quot;)
ess &lt;- recode_missings(ess8) %&gt;% select(idno, cntry, nwspol, vote, contplt, 
                                               wrkprty, wrkorg, badge, sgnptit, pbldmn, 
                                               bctprd, pstplonl, agea, gndr,pspwght)
val_labels(ess) &lt;- NULL

ess$news &lt;- ifelse(ess$nwspol &lt; 30 | is.na(ess$nwspol), 0, 1)
ess$vote1 &lt;- mapvalues(ess$vote, from = c(1,2,3, NA), to = c(1,0,0, NA))
ess$contact &lt;- mapvalues(ess$contplt, from = c(1,2,NA), to = c(1,0,NA))
ess$workparty &lt;- mapvalues(ess$wrkprty, from = c(1,2,NA), to = c(1,0,NA))
ess$workorg &lt;- mapvalues(ess$wrkorg, from = c(1,2,NA), to = c(1,0,NA))
ess$petition &lt;- mapvalues(ess$sgnptit, from = c(1,2,NA), to = c(1,0,NA))
ess$demonstr &lt;- mapvalues(ess$pbldmn, from = c(1,2,NA), to = c(1,0,NA))
ess$postonline &lt;- mapvalues(ess$pstplonl, from = c(1,2,NA), to = c(1,0,NA))
ess$badge1 &lt;- mapvalues(ess$badge, from = c(1,2,NA), to = c(1,0,NA))
ess$boycott &lt;- mapvalues(ess$bctprd, from = c(1,2,NA), to = c(1,0,NA))

names &lt;- c(&quot;news&quot;, &quot;vote1&quot;, &quot;contact&quot;, &quot;workparty&quot;, &quot;workorg&quot;, &quot;petition&quot;, &quot;demonstr&quot;, &quot;postonline&quot;)

data &lt;- ess %&gt;% filter(agea &gt;= 18 &amp; vote != 3) %&gt;% 
                select(names, idno, cntry, pspwght, vote1)

data$country &lt;- countrycode(sourcevar = data$cntry, &quot;iso2c&quot;, &quot;country.name&quot;)</code></pre>
</div>
<div id="weighing-different-forms-of-participation" class="section level4">
<h4>Weighing different forms of participation</h4>
<pre class="r"><code>cntry &lt;- data %&gt;% group_by(cntry) %&gt;% summarise_at(names, funs(weighted.mean(., pspwght)), na.rm = TRUE)

weight_sq &lt;- 1 / sqrt(cntry[names])
newnames &lt;- paste(colnames(weight_sq), &quot;_weight_sq&quot;, sep=&quot;&quot;)
colnames(weight_sq) &lt;- newnames

weight_all &lt;- data %&gt;% summarise_at(names, funs(weighted.mean(., pspwght)), na.rm = TRUE)
weight_all &lt;- 1 / weight_all
newnames &lt;- paste(colnames(weight_all), &quot;_weight_all&quot;, sep=&quot;&quot;)
colnames(weight_all) &lt;- newnames

newnames &lt;- paste(colnames(cntry)[2:9], &quot;_mean&quot;, sep=&quot;&quot;)
colnames(cntry)[2:9] &lt;- newnames

weight &lt;- cbind(cntry[,1], weight_sq, weight_all)

data &lt;- dplyr::left_join(data, weight, by = &quot;cntry&quot;)

data$polpart1 &lt;- rowSums(mapply(`*`,data[,1:8],data[,13:20]))
data$polpart1 &lt;- round(data$polpart1,3)

data$polpart2 &lt;- rowSums(mapply(`*`,data[,1:8],data[,21:28]))
data$polpart2 &lt;- round(data$polpart2,3)

data &lt;- data[!is.na(data$polpart1), ]</code></pre>
</div>
<div id="measures-of-inequality" class="section level4">
<h4>Measures of inequality</h4>
<pre class="r"><code>names &lt;- c(&quot;news&quot;, &quot;vote1&quot;, &quot;contact&quot;, &quot;workparty&quot;, &quot;workorg&quot;, &quot;petition&quot;, &quot;demonstr&quot;, 
          &quot;postonline&quot;, &quot;polpart1&quot;, &quot;polpart2&quot;)

cntrydata &lt;- data %&gt;%  group_by(cntry) %&gt;% summarise_at(names, funs(weighted.mean(., pspwght)), na.rm = TRUE)

cntrydata &lt;- cbind(cntrydata, aggregate(polpart1 ~ cntry, data = data, FUN = &quot;gini&quot;)[,-1])
cntrydata &lt;- cbind(cntrydata, aggregate(polpart1 ~ cntry, data = data, FUN = &quot;entropy.empirical&quot;)[,-1])
cntrydata &lt;- cbind(cntrydata, aggregate(polpart1 ~ cntry, data = data, FUN = &quot;Atkinson&quot;)[,-1])

cntrydata &lt;- cbind(cntrydata, aggregate(polpart2 ~ cntry, data = data, FUN = &quot;gini&quot;)[,-1])
cntrydata &lt;- cbind(cntrydata, aggregate(polpart2 ~ cntry, data = data, FUN = &quot;entropy.empirical&quot;)[,-1])
cntrydata &lt;- cbind(cntrydata, aggregate(polpart2 ~ cntry, data = data, FUN = &quot;Atkinson&quot;)[,-1])

colnames(cntrydata) &lt;- c(&quot;cntry&quot;, &quot;news&quot;, &quot;vote&quot;, &quot;contact&quot;, &quot;work.party&quot;, &quot;work.org&quot;, &quot;petition&quot;, &quot;demonstrate&quot;, &quot;post.online&quot;, &quot;pol.part1&quot;, &quot;pol.part2&quot;, &quot;gini1&quot;, &quot;entropy1&quot;, &quot;atkinson1&quot;, &quot;gini2&quot;, &quot;entropy2&quot;, &quot;atkinson2&quot;)

plot(Lc(data$polpart1[data$cntry == &quot;DE&quot;]),col=&quot;darkred&quot;,lwd=2)</code></pre>
<p><img src="/post/participation-inequality-ess_files/figure-html/inequality-1.png" width="672" /></p>
</div>
<div id="democracy-indicators" class="section level3">
<h3>Democracy indicators</h3>
<pre class="r"><code>democracy &lt;- generate_democracy_scores_dataset(output_format = &quot;wide&quot;, verbose = FALSE)

democracy$iso2 &lt;- countrycode(sourcevar = democracy$extended_country_name, &quot;country.name&quot;, &quot;iso2c&quot;)
democracy$continent &lt;- countrycode(sourcevar = democracy$extended_country_name, &quot;country.name&quot;, &quot;continent&quot;)

democracy$iso2[democracy$extended_country_name == &quot;Kosovo&quot;] &lt;- &quot;KS&quot;
democracy$continent[democracy$extended_country_name == &quot;Kosovo&quot;] &lt;- &quot;Europe&quot;

democracy &lt;- filter(democracy, year == 2016, 
                    !is.na(iso2), !is.na(extended_country_name),
                    (continent == &quot;Europe&quot; | iso2 == &quot;IL&quot;)) %&gt;% 
  select(continent, iso2, year, eiu, fh_total_reversed, polity2, wgi_democracy)</code></pre>
</div>
<div id="v-dem-data" class="section level3">
<h3>V-Dem data</h3>
<pre class="r"><code>vdem.part &lt;- extract_vdem(name_pattern = &quot;v2x_partipdem&quot;, include_uncertainty = FALSE)

vdem.part$continent &lt;- countrycode(sourcevar = vdem.part$vdem_country_name, &quot;country.name&quot;, &quot;continent&quot;)

vdem.part$continent[vdem.part$vdem_country_name == &quot;Kosovo&quot;] &lt;- &quot;Europe&quot;
vdem.part$iso2[vdem.part$vdem_country_name == &quot;Kosovo&quot;] &lt;- &quot;KS&quot;
vdem.part$iso2 &lt;- countrycode(sourcevar = vdem.part$vdem_country_name, &quot;country.name&quot;, &quot;iso2c&quot;)

vdem.part &lt;- filter(vdem.part, year == 2016, continent == &quot;Europe&quot; | vdem_country_name == &quot;Israel&quot;) %&gt;% 
  select(continent, iso2, year, v2x_partipdem, vdem_country_name)</code></pre>
</div>
<div id="joining-v-dem-data-and-democracy-indicators" class="section level3">
<h3>Joining V-Dem data and Democracy indicators</h3>
<pre class="r"><code>all.demo &lt;- full_join(vdem.part, democracy, by = &quot;iso2&quot;)
all.demo &lt;- select(all.demo, iso2, v2x_partipdem, eiu, fh_total_reversed, wgi_democracy, vdem_country_name)
colnames(all.demo) &lt;- c(&quot;cntry&quot;, &quot;vdem.partidem&quot;, &quot;eiu&quot;, &quot;fh.total.reversed&quot;, &quot;wgi.democracy&quot;, &quot;country&quot;)
all.demo &lt;- all.demo[,c(6,2,3,4,5,1)]

cntrydata &lt;- left_join(cntrydata, all.demo, by = &quot;cntry&quot;)</code></pre>
<div id="correlation-matrix" class="section level4">
<h4>Correlation matrix</h4>
<pre class="r"><code>cntrydata_cor &lt;- cntrydata[,c(10,12,13,14,11,15,16,17,19,20,21,22)]
    
M&lt;- cor(cntrydata_cor)
corrplot(M, method = &quot;number&quot;, number.cex = 0.9)</code></pre>
<p><img src="/post/participation-inequality-ess_files/figure-html/correlation-1.png" width="672" /></p>
</div>
<div id="country-histogram" class="section level4">
<h4>Country histogram</h4>
<pre class="r"><code>plot_ly(data[which(data$cntry == &quot;PL&quot;),], 
      x = ~polpart1, type = &quot;histogram&quot;, histnorm = &quot;probability&quot;,
            name = &#39;Sample distribution of the political participation index&#39;) %&gt;%
      layout(title = &quot;Distribution of the political participation index&quot;,
             xaxis = list(title = &quot;Political participation index&quot;),
             yaxis = list(title = &quot;&quot;, range = c(0,1)),
             margin = list(t = 100, b = 100))</code></pre>
<div id="f45c7296596c" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="f45c7296596c">{"x":{"visdat":{"f45c38a31ae1":["function () ","plotlyVisDat"]},"cur_data":"f45c38a31ae1","attrs":{"f45c38a31ae1":{"x":{},"histnorm":"probability","name":"Sample distribution of the political participation index","alpha":1,"sizes":[10,100],"type":"histogram"}},"layout":{"margin":{"b":100,"l":60,"t":100,"r":10},"title":"Distribution of the political participation index","xaxis":{"domain":[0,1],"title":"Political participation index"},"yaxis":{"domain":[0,1],"title":"","range":[0,1]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[1.161,6.142,2.251,1.09,1.09,1.161,2.251,9.454,1.161,6.142,6.222,0,2.251,5.04,2.251,1.09,2.251,2.251,1.161,17.329,1.09,2.251,2.251,6.142,2.251,1.09,1.09,2.251,1.09,11.095,2.251,1.09,1.161,1.09,1.09,2.251,1.161,2.251,2.251,2.251,2.251,12.902,1.161,8.944,2.251,2.251,7.921,3.95,2.251,2.251,1.09,2.251,0,2.251,2.251,2.251,1.161,2.251,2.251,1.09,1.161,2.251,5.04,5.563,1.09,25.105,0,1.09,6.155,6.142,12.902,2.251,5.04,1.09,1.09,6.222,2.251,3.879,2.251,2.251,1.161,2.251,2.251,2.251,1.09,1.09,11.741,2.251,3.95,1.09,4.473,2.251,2.251,1.161,2.251,2.251,1.161,2.251,2.251,2.251,5.563,2.251,1.09,2.251,2.251,5.04,0,2.251,2.251,1.09,2.251,6.142,19.516,2.251,2.251,2.251,2.251,2.251,5.04,1.09,2.251,2.251,1.09,1.09,1.09,2.251,2.251,2.251,1.09,2.251,6.142,2.251,2.251,2.251,5.563,1.09,2.251,2.251,2.251,2.251,1.09,1.09,2.251,1.161,5.563,2.251,2.251,2.251,2.251,2.251,2.251,8.352,2.251,2.251,0,2.251,6.142,2.251,8.352,1.09,2.251,1.09,6.222,2.251,2.251,2.251,2.251,2.251,2.251,2.251,9.011,2.251,1.161,2.251,2.251,15.716,2.251,8.944,2.251,1.09,1.09,1.09,2.251,5.563,1.09,1.161,1.161,1.09,1.09,2.251,2.251,3.891,5.04,1.09,1.161,12.233,1.09,2.251,2.251,2.251,1.09,2.251,1.09,2.251,2.251,2.251,1.161,1.161,2.251,2.251,1.09,2.251,2.251,1.09,9.011,2.251,2.251,8.931,1.09,2.251,6.222,8.352,10.113,1.09,0,2.251,9.011,1.161,1.161,1.161,13.358,2.251,1.09,8.293,1.09,8.944,2.251,0,9.467,2.251,0,2.251,5.04,1.09,11.812,1.161,2.251,5.04,2.251,1.09,11.812,9.467,2.251,1.09,1.09,1.161,6.142,6.155,14.429,2.251,1.09,2.251,1.09,2.251,0,2.251,8.956,2.251,2.251,1.09,2.251,0,0,2.251,2.251,5.04,2.251,0,1.09,1.09,4.473,2.251,1.09,1.09,2.251,6.142,2.251,2.251,6.222,5.061,1.09,2.251,1.09,6.222,2.251,2.251,0,5.563,2.251,2.789,1.09,3.95,3.312,1.09,2.251,2.251,0,1.09,2.251,2.251,2.251,2.251,1.09,6.222,2.251,2.251,0,6.222,2.251,2.251,2.251,1.09,0,2.251,2.251,1.09,2.251,7.77,4.473,2.251,2.251,5.04,5.04,5.563,5.563,4.402,1.09,1.09,1.09,2.251,16.806,2.251,1.161,5.563,0,2.251,2.251,1.09,1.09,2.251,1.09,2.251,0,19.516,2.251,2.251,1.161,2.251,22.291,5.04,2.251,1.09,15.021,1.161,1.09,1.09,2.251,2.251,2.251,2.251,3.879,2.251,15.021,0,2.251,2.251,2.251,1.09,2.251,1.161,2.251,1.161,2.251,1.161,2.251,17.172,1.161,2.251,0,1.09,2.251,2.251,2.251,2.251,0,1.09,1.09,1.09,8.931,1.09,2.251,2.251,1.09,2.251,1.09,2.251,1.09,1.161,2.251,2.251,2.251,1.09,2.251,2.251,12.256,2.251,2.251,2.251,5.04,6.142,4.402,2.251,1.09,2.251,2.251,1.09,2.251,2.251,2.251,26.195,1.161,1.09,2.251,7.191,2.251,2.251,8.352,1.161,2.251,2.251,2.251,2.251,5.04,2.251,2.251,2.251,1.09,2.251,2.251,5.04,2.251,2.251,2.251,1.09,5.04,17.172,2.251,2.251,2.251,2.251,6.142,11.812,2.251,1.09,2.251,2.251,1.161,2.251,2.251,2.251,2.251,0,1.09,1.161,10.113,1.09,1.09,2.251,5.04,1.09,2.251,7.167,1.09,2.251,12.323,2.251,2.251,1.09,2.251,2.251,1.09,2.251,2.251,2.251,9.467,2.251,2.251,1.09,2.251,2.251,2.251,2.251,8.931,1.09,2.251,3.95,1.09,1.09,2.251,22.304,1.161,2.251,2.251,2.251,2.251,2.251,2.251,1.09,0,2.251,2.251,2.251,5.04,2.251,17.751,2.251,2.251,1.09,6.155,5.563,1.09,1.09,7.854,2.251,1.09,1.09,1.161,5.04,2.251,2.251,2.251,2.251,1.09,2.251,2.251,1.09,1.09,0,2.251,1.09,1.161,2.251,1.09,2.251,2.251,2.251,2.251,2.251,5.132,8.944,5.061,1.09,2.251,9.011,5.563,6.142,2.251,1.09,1.09,2.251,2.251,4.473,9.454,2.251,2.251,2.251,2.251,2.251,2.251,2.251,11.082,2.251,2.251,9.011,1.161,12.902,2.251,0,2.251,2.251,1.09,15.009,1.09,2.251,9.467,1.161,2.251,2.251,3.891,2.251,11.233,2.251,5.04,2.251,16.227,1.161,16.147,2.251,2.251,8.364,2.251,5.04,0,2.251,2.251,1.161,1.161,2.251,2.251,1.161,2.251,5.563,2.251,2.251,20.118,2.251,1.09,1.161,2.251,1.09,5.563,6.222,1.09,1.09,1.161,1.09,2.251,0,8.944,1.161,1.09,2.251,12.323,12.835,1.09,2.251,2.251,2.251,5.04,2.251,1.09,1.161,2.251,0,1.161,2.251,2.251,2.251,2.251,1.09,2.251,1.09,2.251,2.251,2.251,2.251,2.251,5.052,1.09,2.251,18.992,2.251,2.251,2.251,2.251,1.09,0,12.915,2.251,2.251,2.251,15.544,1.09,16.806,3.95,9.011,0,2.251,2.251,1.09,2.251,2.251,2.251,2.251,2.251,0,2.251,1.161,1.09,2.251,1.09,1.161,2.251,0,1.09,8.931,1.09,1.09,1.09,2.251,1.09,2.251,2.251,3.95,1.161,2.251,2.251,2.251,2.251,2.251,2.251,2.251,7.239,2.251,2.251,1.09,2.251,2.251,1.09,2.251,4.473,4.981,2.251,5.04,1.09,2.251,2.251,2.251,2.251,2.251,2.251,2.251,1.161,2.251,2.251,1.161,1.09,2.251,2.251,1.09,2.251,1.161,2.251,2.251,26.195,1.09,2.251,2.251,2.251,2.251,2.251,9.011,8.352,1.09,2.251,4.473,2.251,2.251,2.251,2.251,4.402,1.161,2.251,5.04,9.011,1.09,2.251,6.222,7.191,2.251,1.161,2.251,9.467,2.251,1.09,2.251,2.251,2.251,2.251,18.333,0,2.251,2.251,1.09,10.126,1.09,1.09,1.09,2.251,2.251,2.251,1.161,2.251,16.227,12.915,2.251,18.32,2.251,9.011,2.251,5.563,2.251,6.693,1.09,0,1.161,1.09,1.09,2.251,2.251,2.251,5.04,2.251,2.251,1.09,2.251,2.251,6.142,3.879,7.203,2.251,2.251,1.09,3.95,1.161,0,2.251,1.09,4.994,1.161,2.251,8.931,1.161,5.04,0,2.251,2.251,2.251,1.09,2.251,12.243,2.251,16.147,2.251,5.04,2.251,2.251,2.251,1.09,2.251,2.251,3.879,2.251,0,5.132,5.563,6.155,2.251,1.09,2.251,2.251,2.251,2.251,2.251,2.251,1.09,2.251,8.931,0,1.09,2.251,1.161,1.09,6.142,6.155,12.902,2.251,1.09,1.161,6.155,1.09,4.994,1.161,1.161,2.251,2.251,1.09,0,2.251,2.251,2.251,2.251,2.251,2.251,1.09,1.09,19.516,2.251,1.161,1.161,2.251,2.251,2.251,2.251,2.251,1.161,2.251,1.161,1.09,1.161,5.04,2.251,1.09,2.251,1.09,1.09,2.251,9.011,2.251,1.09,1.09,8.952,1.161,2.251,2.251,8.931,1.09,6.222,2.251,1.09,4.402,2.251,2.251,1.09,2.251,2.251,2.251,2.251,1.09,2.251,1.09,1.09,12.902,5.563,1.09,1.161,2.251,5.04,2.251,1.09,6.142,1.09,16.227,2.251,3.95,1.09,2.251,2.251,2.251,1.09,2.251,2.251,4.473,2.251,9.011,2.251,5.563,1.09,1.09,1.09,2.251,1.09,1.09,1.09,2.251,2.251,4.402,6.155,2.251,2.251,2.251,15.544,15.034,1.161,2.251,1.161,2.251,2.251,0,2.251,2.251,16.147,3.95,3.95,3.879,5.563,22.884,1.161,4.402,1.161,2.251,5.04,5.563,2.251,14.429,2.251,2.251,1.09,2.251,1.161,0,12.256,2.251,0,2.251,2.251,2.251,2.251,1.09,13.358,2.251,9.467,5.04,5.563,2.251,0,1.09,5.04,2.251,1.09,2.251,1.09,2.251,2.251,1.09,2.251,2.251,1.161,2.251,2.251,2.251,2.251,9.467,0,1.09,3.95,8.931,2.251,2.251,6.222,5.04,12.902,2.251,2.251,2.251,1.09,1.161,2.251,1.09,1.161,2.251,5.563,2.251,2.251,2.251,2.251,2.251,2.251,2.251,0,2.251,1.09,2.251,2.251,1.09,1.09,2.251,1.09,2.251,2.251,1.161,1.09,1.09,6.155,16.806,8.329,2.251,11.741,5.563,5.04,1.09,2.251,2.251,3.879,1.09,1.161,12.323,17.243,2.251,1.161,2.251,9.467,2.251,2.251,2.251,2.251,5.563,9.981,2.251,8.352,1.09,2.251,2.251,1.161,1.09,9.467,6.68,2.251,2.251,1.09,0,2.251,5.04,2.251,18.333,2.251,2.251,1.09,1.161,2.251,0,6.142,2.251,1.09,2.251,2.251,2.251,0,5.061,1.161,9.467,0,2.251,2.251,1.09,1.09,5.04,2.251,2.251,2.251,2.251,2.251,1.09,5.04,2.251,1.09,2.251,2.251,18.333,2.251,2.251,1.09,0,1.09,2.251,1.09,6.142,2.251,2.251,1.161,1.09,2.251,1.09,2.251,1.09,5.04,2.251,1.09,2.251,0,2.251,2.251,1.161,1.161,2.251,7.783,2.251,2.251,9.467,2.251,2.251,2.251,1.09,1.09,8.352,2.251,1.161,6.142,2.251,2.251,2.251,2.251,2.251,2.251,3.95,8.944,2.251,2.251,2.251,1.09,2.251,8.931,2.789,2.251,2.251,1.09,2.251,1.161,1.161,0,2.251,2.251,1.161,1.09,2.251,6.155,7.841,2.251,1.161,2.251,1.09,1.09,2.251,2.251,2.251,2.251,4.402,2.251,3.95,1.09,6.142,2.251,9.467,0,2.251,2.251,5.04,10.126,1.09,2.251,2.251,2.251,2.251,2.251,2.251,3.95,7.854,1.09,21.214,1.09,2.251,2.251,2.251,2.251,1.161,2.251,1.161,2.251,2.251,2.251,5.563,15.021,2.251,2.251,2.251,1.09,4.402,2.251,5.563,1.09,0,2.251,12.323,1.161,5.563,2.251,2.251,2.251,0,2.251,1.09,1.09,2.251,0,16.806,2.251,2.251,1.09,0,2.251,2.251,12.902,2.251,2.251,2.251,1.09,2.251,1.161,2.251,2.251,5.04,0,4.402,2.251,1.09,2.251,2.251,1.09,1.09,12.243,2.251,2.251,0,2.251,1.09,2.251,2.251,6.101,1.09,1.09,2.251,15.124,2.251,2.251,2.251,2.251,2.251,9.011,1.09,5.04,2.251,1.161,2.251,2.251,0,2.251,5.563,1.09,13.358,1.161,1.161,2.251,2.251,1.09,6.155,1.09,8.352,2.251,1.09,2.251,0,1.09,2.251,2.251,12.3,1.161,2.251,2.251,12.256,1.161,5.04,2.251,2.251,0,2.251,1.09,2.251,2.251,2.251,1.09,5.563,5.563,1.161,1.09,1.09,2.251,2.251,10.113,2.251,1.161,2.251,1.09,2.251,6.155,8.306,2.251,2.251,1.09,2.251,1.09,13.339,10.113,5.563,2.251,8.931,1.161,1.09,6.222,2.251,2.251,2.251,2.251,1.09,22.304,2.251,1.161,2.251,1.161,7.841,1.09,1.161,5.563,2.251,5.052,2.251,11.64,1.09,2.251,2.251,1.09,2.251,2.789,2.251,1.09,1.09,5.563,1.09,18.992,2.251,1.09,2.251,2.251,4.473,5.04,0,2.251,2.251,2.251,6.222,1.09,2.251,2.251,1.09,1.09,1.09,2.251,2.251,6.142,2.251,12.915,2.251,1.09,2.251,1.09,8.931,1.09,5.563,2.251,5.563,5.563,3.879,5.563,2.251,4.473,3.95,2.251,1.161,2.251,2.251,1.161,2.251,7.841,0,2.251,15.544,2.251,2.251,0,5.563,5.563,6.155,2.251,2.251,4.402,9.454,5.065,2.251,1.09,5.563,2.251,2.251,6.222,2.251,2.251,1.09,2.251,2.251,2.251,16.806,3.891,16.227,1.161,1.09,2.251,12.323,2.251,2.251,5.04,2.251,1.161,2.251,2.251,2.251,7.783,5.563,1.09,1.161,2.251,2.251,2.251,9.454,2.251,2.251,2.251,2.251,2.251,11.812,1.161,1.09,9.011,1.09,5.04,2.251,2.251,1.09,22.884,1.09,2.251,1.09,2.251,2.251,5.04,2.251,11.64,1.09,2.251,2.251,2.251,2.251,2.251,2.251,3.312,19.516,2.251,1.09,2.251],"histnorm":"probability","name":"Sample distribution of the political participation index","type":"histogram","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="country-lorenz-curve" class="section level4">
<h4>Country Lorenz curve</h4>
<pre class="r"><code>plot(Lc(data$polpart1[which(data$cntry == &quot;PL&quot;)]),col=&quot;darkred&quot;,lwd=2)</code></pre>
<p><img src="/post/participation-inequality-ess_files/figure-html/lorenz%20curve-1.png" width="672" /></p>
</div>
<div id="bar-plot" class="section level4">
<h4>Bar plot</h4>
<pre class="r"><code>plot_ly(data = cntrydata, x = ~factor(cntry), y = ~pol.part1, 
        name = &quot;Level of PPI&quot;, type = &quot;bar&quot;, marker = list(color = &#39;rgb(49,130,189)&#39;), 
        hoverinfo = &#39;text&#39;, text = ~paste(cntry, &#39;&lt;br&gt;Mean:&#39;, pol.part1))  %&gt;%
  add_trace(y = ~gini1, name = &#39;Gini index of PPI&#39;, 
            marker = list(color = &#39;rgb(204,204,204)&#39;),
            hoverinfo = &#39;text&#39;, text = ~paste(cntry, &#39;&lt;br&gt;Gini index:&#39;, gini1)) %&gt;%
  layout(title = &quot;Levels and inequality of the political participation index by country&quot;,
         xaxis = list(title = &quot;&quot;, tickangle = -45),
         yaxis = list(title = &quot;&quot;, range = c(0,6)),
         margin = list(t = 100, b = 100),
         barmode = &#39;group&#39;)</code></pre>
<div id="f45c3e9d6be0" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="f45c3e9d6be0">{"x":{"visdat":{"f45c26182474":["function () ","plotlyVisDat"]},"cur_data":"f45c26182474","attrs":{"f45c26182474":{"x":{},"y":{},"name":"Level of PPI","marker":{"color":"rgb(49,130,189)"},"hoverinfo":"text","text":{},"alpha":1,"sizes":[10,100],"type":"bar"},"f45c26182474.1":{"x":{},"y":{},"name":"Gini index of PPI","marker":{"color":"rgb(204,204,204)"},"hoverinfo":"text","text":{},"alpha":1,"sizes":[10,100],"type":"bar"}},"layout":{"margin":{"b":100,"l":60,"t":100,"r":10},"title":"Levels and inequality of the political participation index by country","xaxis":{"domain":[0,1],"title":"","tickangle":-45,"type":"category","categoryorder":"array","categoryarray":["AT","BE","CH","CZ","DE","EE","ES","FI","FR","GB","HU","IE","IL","IS","IT","LT","NL","NO","PL","PT","RU","SE","SI"]},"yaxis":{"domain":[0,1],"title":"","range":[0,6]},"barmode":"group","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":["AT","BE","CH","CZ","DE","EE","ES","FI","FR","GB","HU","IE","IL","IS","IT","LT","NL","NO","PL","PT","RU","SE","SI"],"y":[4.1456524872746,4.14122929599851,4.14716981436105,3.52086270405304,4.34475633311888,3.52940211863279,4.53405820464754,4.29239945748689,4.02423600815209,4.07608306209092,2.84443729038558,3.90018240379156,3.53298645585713,5.1874416934823,3.55496056317969,2.94556303323906,4.23297663063225,4.68514975068456,3.34980146118262,4.03726870639108,2.77871708793761,4.64677253753628,3.62383750411405],"name":"Level of PPI","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgb(49,130,189)","line":{"color":"transparent"}},"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"text":["AT <br>Mean: 4.1456524872746","BE <br>Mean: 4.14122929599851","CH <br>Mean: 4.14716981436105","CZ <br>Mean: 3.52086270405304","DE <br>Mean: 4.34475633311888","EE <br>Mean: 3.52940211863279","ES <br>Mean: 4.53405820464754","FI <br>Mean: 4.29239945748689","FR <br>Mean: 4.02423600815209","GB <br>Mean: 4.07608306209092","HU <br>Mean: 2.84443729038558","IE <br>Mean: 3.90018240379156","IL <br>Mean: 3.53298645585713","IS <br>Mean: 5.1874416934823","IT <br>Mean: 3.55496056317969","LT <br>Mean: 2.94556303323906","NL <br>Mean: 4.23297663063225","NO <br>Mean: 4.68514975068456","PL <br>Mean: 3.34980146118262","PT <br>Mean: 4.03726870639108","RU <br>Mean: 2.77871708793761","SE <br>Mean: 4.64677253753628","SI <br>Mean: 3.62383750411405"],"type":"bar","xaxis":"x","yaxis":"y","frame":null},{"x":["AT","BE","CH","CZ","DE","EE","ES","FI","FR","GB","HU","IE","IL","IS","IT","LT","NL","NO","PL","PT","RU","SE","SI"],"y":[0.426500878556396,0.392147077041614,0.415125191326638,0.530852235451732,0.376223424235491,0.433659975797127,0.42460470756231,0.359582606310312,0.43670119671043,0.426375152797675,0.472564429425404,0.430915417303709,0.45256909480463,0.3195863025569,0.476370294619073,0.505596310979683,0.362629668462091,0.344626641619527,0.459613238074951,0.419473977774544,0.537122929745294,0.329980400964018,0.441892702368904],"name":"Gini index of PPI","marker":{"fillcolor":"rgba(255,127,14,1)","color":"rgb(204,204,204)","line":{"color":"transparent"}},"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"text":["AT <br>Gini index: 0.426500878556396","BE <br>Gini index: 0.392147077041614","CH <br>Gini index: 0.415125191326638","CZ <br>Gini index: 0.530852235451732","DE <br>Gini index: 0.376223424235491","EE <br>Gini index: 0.433659975797127","ES <br>Gini index: 0.42460470756231","FI <br>Gini index: 0.359582606310312","FR <br>Gini index: 0.43670119671043","GB <br>Gini index: 0.426375152797675","HU <br>Gini index: 0.472564429425404","IE <br>Gini index: 0.430915417303709","IL <br>Gini index: 0.45256909480463","IS <br>Gini index: 0.3195863025569","IT <br>Gini index: 0.476370294619073","LT <br>Gini index: 0.505596310979683","NL <br>Gini index: 0.362629668462091","NO <br>Gini index: 0.344626641619527","PL <br>Gini index: 0.459613238074951","PT <br>Gini index: 0.419473977774544","RU <br>Gini index: 0.537122929745294","SE <br>Gini index: 0.329980400964018","SI <br>Gini index: 0.441892702368904"],"type":"bar","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="scatter-plot" class="section level4">
<h4>Scatter plot</h4>
<p>appel &lt;- rijksPalette(“Karel Appel”) colfunc &lt;- colorRampPalette(c(“white”, appel$palette(23)[7]))</p>
<p>plot_ly(data = cntrydata, type = “scatter”, x = ~gini1, y = ~pol.part1, color = ~cntry, colors = “Set1”, marker = list(size = 10), hoverinfo = ‘text’, text = ~paste(‘country’, cntry, ‘<br>Pol.part.mean:’, round(pol.part1,3), ‘<br>Pol.part.gini:’, round(gini1,3))) %&gt;% layout(title = “Levels and inequality of the political participation index by country”, xaxis = list(title = “Gini index of PPI”, range = c(0,0.6)), yaxis = list(title = “Level of PPI”, range = c(0,6)), margin = list(t = 100, b = 100), showlegend = FALSE)</p>
<p>```</p>
</div>
</div>
